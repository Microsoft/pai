# 推荐做法

管理一个或多个集群并非易事。 在大多数情况下，管理员应具有丰富的Op enPAI系统知识。 在这里，我们推荐一些实践经验，供管理员参考。

## 团队共同实践

OpenPAI中主要有两种资源，即虚拟集群资源和存储资源，它们由组进行管理。所有用户都在`默认`组中。因此，每个人都应有权访问`默认`虚拟集群以及为`默认`组设置的一个或多个存储。除了`默认`组外，您可以为不同的用户设置不同的组。 **实际上，我们建议您为每个团队分配一个小组。**

例如，如果您有两个团队：团队A在项目A上工作； 您可以分别为团队A和B设置A组和B组。 因此，每个团队都可以在内部共享计算和存储资源。 如果用户加入团队，只需将其添加到相应的组中即可。

默认情况下，OpenPAI使用基本身份验证模式。 在此模式下，虚拟群集完全绑定到组，这意味着设置组意味着以基本身份验证模式设置虚拟群集。 在AAD模式下，组和虚拟群集是不同的概念。 有关详细信息，请参考[如何设置虚拟群集](./如何设置虚拟集群.md)。

## 新用户实践

对于以基本身份验证模式启动的新用户，PAI管理员应在后端手动创建此用户，并向用户通知一些说明和准则。 在我们的实践中，我们将向新用户发送电子邮件。 除了帐户信息外，我们还在电子邮件中包含以下内容：

  - 让用户阅读[用户手册](../cluster-user/)，以了解如何提交任务，调试任务以及使用客户端工具。
  - 让用户知道其完成的任务可能在30天后被删除。
  - 让用户知道他/她不应该总是执行低效率的工作（例如，在容器中休眠几天）。 否则，管理员可能会终止该任务。
  - 让用户知道如何在发现任何问题或有任何疑问时与管理员联系。
  
## DRI实践

DRI代表指定负责人。 在我们的上下文中，我们没有一位专门负责PAI群集的管理员。 相反，我们每周分配一个或两个DRI。 他/她将在本周成为集群管理的指定负责人。 分配基于轮换，因此团队中的每个人都有平等的机会成为DRI。

DRI的职责包括：

- 解决内部部署的实时站点问题，这些问题来自警报和人工报告，包括集群警报和用户问题。
- 升级PAI服务。

DRI应该意识到不同的严重性：

  - 严重性0：影响整个产品集群，并且完全不可用。
  - 严重性1：影响重要功能，例如无法提交新任务，API完全失败或Web UI中断。
  - 严重级别2：某些任务始终失败，或者某些用户经常遇到问题。
  - 严重级别3：随机任务失败的可能性很小。

另外，如果存在多个集群，则他/她还应该了解不同集群的不同优先级。

根据严重性和优先级，我们可以为集群管理制定SLA。 这是一个例子：

|     严重程度    |     集群               |     确认    |     更新频率    |     监控时间    |
|-----------------|---------------------------|--------------------|-------------------------|-------------------------|
|     0, 1        |     生产集群    |     30 分钟     |     2 小时              |     工作时间       |
|     2           |     生产集群    |     2 小时        |     24 小时            |     工作时间       |
|     3           |     全部                   |     4 小时        |     24 小时            |     工作时间       |


如果出现问题，DRI应该按照以下步骤解决：

1. 发送给DRI的所有问题或通知应由DRI所有者主动更新。
2. DRI所有者应向每个PAI警报事件发送ACK。 由于存在许多重复的警报，因此不需要对每个警报进行ACK。
3. 除了ACK，如果有更新或已解决，DRI所有者还应答复问题/通知/警报。 更进一步，DRI所有者应考虑该事件的发生原因，解决后的下一次如何避免。 如果适用，请在Github上创建问题。