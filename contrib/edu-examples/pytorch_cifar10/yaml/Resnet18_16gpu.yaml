protocolVersion: 2
name: demo
type: job
jobRetryCount: 0
prerequisites:
  - type: dockerimage
    uri: 'openpai/standard:python_3.6-pytorch_1.2.0-gpu'
    name: docker_image_1
taskRoles:
  chief:
    instances: 2
    completion:
      minFailedInstances: 1
      minSucceededInstances: -1
    taskRetryCount: 0
    dockerImage: docker_image_1
    resourcePerInstance:
      gpu: 4
      cpu: 16
      memoryMB: 32768
    commands:
      - branch_name=pai-for-edu
      - >-
        wget
        https://raw.githubusercontent.com/suiguoxin/pai/${branch_name}/contrib/edu-examples/pytorch_cifar10/src/demo.py
      - python3 demo.py
defaults:
  virtualCluster: default
extras:
  com.microsoft.pai.runtimeplugin:
    - plugin: ssh
      parameters:
        jobssh: true
    - plugin: teamwise_storage
      parameters:
        storageConfigNames:
          - confignfs
